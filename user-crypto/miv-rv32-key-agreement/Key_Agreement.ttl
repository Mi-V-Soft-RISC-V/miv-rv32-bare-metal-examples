; Tera Term Setting:
; 1. Before running Tera Term Macro script, you should set language as English 
;   and transmit delay in Serial port setup to 5msec/char and 5msec/line.
; 2. By default, Tera Term log will be stored in Tera Term installation Directory.
changedir '.'
logopen "Key_Agreement.log" 0 0 0 1

settitle 'PolarFire User Crypto Key Agreement service'

setsync 1

; Set baud rate to 115200
setbaud 115200

; local echo off
setecho 0

; ----------------------------------------------------------------------------------------------------------------------------------------------------------
; INPUT
;   P = 
;       a25cb1199622be09d9f473695114963cbb3b109f92df6da1b1dcab5e8511e9a117e2881f30a78f04d6a3472b8064eb6416c
;       dfd7bb8b9891ae5b5a1f1ee1da0cace11dab3ac7a50236b22e105dbeef9e45b53e0384c45c3078acb6ee1ca983511795801
;       da3d14fa9ed82142ec47ea25c0c0b7e86647d41e9f55955b8c469e7e298ea30d88feacf43ade05841008373605808a2f8f8
;       910b195f174bd8af5770e7cd85380d198f4ed2a0c3a2f373436ae6ce9567846a79275765ef829abbc6171718f7746ebd167
;       d406e2546acdea7299194a613660d5ef721cd77e7722095c4ca42b29db3d4436325b47f850af05d411c7a95ccc54555c193
;       384a6eeebb47e6f0f
;       
;   Q = a944d488de8c89567b602bae44478632604f8bf7cb4deb851cf6e22d
;   G = 
;       1e2b67448a1869df1ce57517dc5e797b62c5d2c832e23f954bef8bcca74489db6caed2ea496b52a52cb664a168374cb176d
;       dc4bc0068c6eef3a746e561f8dc65195fdaf12b363e90cfffdac18ab3ffefa4b2ad1904b45dd9f6b76b477ef8816802c7bd
;       7cb0c0ab25d378098f5625e7ff737341af63f67cbd00509efbc6470ec38c17b7878a463cebda80053f36558a308923e6b41
;       f465385a4f24fdb303c37fb998fc1e49e3c09ce345ff7cea18e9cd1457eb93daa87dba8a31508fa5695c32ce485962eb183
;       4144413b41ef936db71b79d6fe985c018ac396e3af25054dbbc95e56ab5d4d4b7b61a70670e789c336b46b9f7be43cf6eb0
;       e68b40e33a55d55cc
;   XstatCAVS = 74162ac74759e85654e0e7762c2cdd2689009b24dae06d0a85260b81
;   YstatCAVS = 
;       23ed27e3e655e0a15027d8e75dc97d72756875ff7caab2c3882f0461bacfe599e1391567f2f1406ba841b7ce366a7726ee1
;       f3b56912de4c11f83d8d4096fffe4290ebfe3ffc3c11e9d6a2a1683d16222504d188a2265d678892ed39feaa17aae98ef39
;       cbbce0a765ec9a16d79f369a65c47f93ecdf3a2c6f15e5d112dd197c9593532953a2518cf1c6d336b77ad20aba67e150c3e
;       94037aced49d557d63c48958253c2dc0d66bec9d0bc93739f300d1e1785d58ce3b7a50e65b3742e4de26c3a3db3e66055ae
;       59117464d8dcea7435a6a95396e595146f61cffe6f5650b2d5231f629966e54630ed80b7d6dc03144bf379cf85acf13dd28
;       5a1ee2bab4fe996a2
;   XstatIUT = 8280294a47d4748d853da60d016d1b03320b64df43188c882204f371
;   YstatIUT = 
;       86c59d66dc53689cdc6b60ca7628afa58759b27ffa0856d0037d390d60c14d86385bde5ed5bc6f7e0ab8e5f07d08a47b648
;       abd10865d9f4c9ee7cf5f7982c63a52a33b96482a94b1ece4a99022ec4aa41c7453648089152093a84d16e16039d71db9aa
;       a2aa701f483f6297c4d2647079290a2b94c9bf9ecaa6715758135898504130e381795adf7352b37d1be696012a03dcea475
;       0e963365a7698355364cbedf1715abcb31e3b2aa072dfe15ffd4c2e7d69c8ed7dbb138522536b5e74495724fe4e74b662b9
;       af8c5a35616b9dde39c80041cc6ac62aeae2b802f91b62e9be27dae8006797529db42b2ad8a16353ba6a5d25ea25d443126
;       9ea6fc397de3f16ed
;
;  OUTPUT
;   Z = 
;       59ae47dfd2893b37bb229b05f19ec181b8bc7bace31d0ac37b27e364ea4ca179bb574d91fc554009195ee13bfd3877baa54
;       ed390eab7aa3dfd6f3a35a776a80f58999d7931a9f0d842eb9bad51a24f2d052e56d09ade631f5e3ba64e957e4d583e20ad
;       35d5336708482dd59b80a351e664a724cdf28a7796d2e93fffc7b113a8288be2b562af9dc3f980c917d56a723351b7f4be2
;       d7384b51f69335cf6a2fde5fa4f151be66529a4c8e8850b9c98dcae3a84d0ac231845e2b3771b9c5583960490994a58ff0d
;       748333f92d835f2886ff26b81ebf4b7d7dd6d052d3f2f3062f137ef3fcab8c95771ad837b0af0378d75285126151db08fd0
;       cea5aa9933ffebc50
; ----------------------------------------------------------------------------------------------------------------------------------------------------------

pause 1

;G
pause 1
send '1e2b67448a1869df1ce57517dc5e797b62c5d2c832e23f954bef8bcca74489db6caed2ea496b52a52cb664a168374cb176dd'
send 'c4bc0068c6eef3a746e561f8dc65195fdaf12b363e90cfffdac18ab3ffefa4b2ad1904b45dd9f6b76b477ef8816802c7bd7c'
send 'b0c0ab25d378098f5625e7ff737341af63f67cbd00509efbc6470ec38c17b7878a463cebda80053f36558a308923e6b41f46'
send '5385a4f24fdb303c37fb998fc1e49e3c09ce345ff7cea18e9cd1457eb93daa87dba8a31508fa5695c32ce485962eb1834144'
send '413b41ef936db71b79d6fe985c018ac396e3af25054dbbc95e56ab5d4d4b7b61a70670e789c336b46b9f7be43cf6eb0e68b4'
send '0e33a55d55cc'
pause 5

;XstatCAVS
pause 2
send '74162ac74759e85654e0e7762c2cdd2689009b24dae06d0a85260b81'

;P
pause 2
send 'a25cb1199622be09d9f473695114963cbb3b109f92df6da1b1dcab5e8511e9a117e2881f30a78f04d6a3472b8064eb6416c'
send 'dfd7bb8b9891ae5b5a1f1ee1da0cace11dab3ac7a50236b22e105dbeef9e45b53e0384c45c3078acb6ee1ca983511795801'
pause 2
send 'da3d14fa9ed82142ec47ea25c0c0b7e86647d41e9f55955b8c469e7e298ea30d88feacf43ade05841008373605808a2f8f8'
send '910b195f174bd8af5770e7cd85380d198f4ed2a0c3a2f373436ae6ce9567846a79275765ef829abbc6171718f7746ebd167'
pause 2
send 'd406e2546acdea7299194a613660d5ef721cd77e7722095c4ca42b29db3d4436325b47f850af05d411c7a95ccc54555c193'
send '384a6eeebb47e6f0f'

;YstatIUT
pause 2
send '86c59d66dc53689cdc6b60ca7628afa58759b27ffa0856d0037d390d60c14d86385bde5ed5bc6f7e0ab8e5f07d08a47b648'
send 'abd10865d9f4c9ee7cf5f7982c63a52a33b96482a94b1ece4a99022ec4aa41c7453648089152093a84d16e16039d71db9aa'
pause 4
send 'a2aa701f483f6297c4d2647079290a2b94c9bf9ecaa6715758135898504130e381795adf7352b37d1be696012a03dcea475'
send '0e963365a7698355364cbedf1715abcb31e3b2aa072dfe15ffd4c2e7d69c8ed7dbb138522536b5e74495724fe4e74b662b9'
send 'af8c5a35616b9dde39c80041cc6ac62aeae2b802f91b62e9be27dae8006797529db42b2ad8a16353ba6a5d25ea25d443126'
pause 4
send '9ea6fc397de3f16ed'
send 13

pause 10
logclose